# 掌上公交汽车查询系统
## 测试报告

**项目名称：** 基于移动端的掌上公交汽车查询系统  
**版本号：** 1.0  
**编制日期：** 2026年1月5日  
**测试周期：** 2026年1月1日 ~ 2026年1月5日  

---

## 1. 测试概述

### 1.1 测试目的
- 验证系统功能的正确性和完整性
- 发现并记录系统缺陷和不足
- 评估系统质量是否达到验收标准
- 确保系统在生产环境安全稳定运行

### 1.2 测试范围
- **功能测试**：核心业务流程和用例测试
- **性能测试**：系统响应时间、并发能力
- **安全测试**：权限控制、数据保护
- **兼容性测试**：不同设备、操作系统支持

### 1.3 测试工具与环境
| 工具/环境 | 版本/配置 |
|---------|---------|
| 测试工具 | TestNG, Selenium, JMeter, Postman |
| 测试数据库 | MySQL 5.7, Redis 6.0 |
| 测试设备 | Android 10/11/12, iOS 14/15 |
| 测试网络 | WiFi, 4G, 模拟低速网络 |

---

## 2. 核心功能模块测试用例

### 2.1 **功能界面1：实时导乘与车辆查询**

#### 2.1.1 功能说明
用户可以查询公交线路、查看车辆实时位置、预计到站时间等。

#### 2.1.2 等价类分析

**有效等价类：**

| 类别 | 测试数据 | 预期结果 |
|-----|---------|--------|
| EC1-有效出发地 | "火车站" | 系统返回包含"火车站"的所有线路 |
| EC2-有效目的地 | "人民广场" | 系统返回包含"人民广场"的所有线路 |
| EC3-有效线路 | "201路" | 显示线路详情、实时车位、预计到站时间 |
| EC4-有效车辆ID | "车辆001" | 显示该车辆GPS位置、速度、载客数等 |
| EC5-城市范围查询 | 附近1km内的线路 | 返回该范围内的所有线路 |

**无效等价类：**

| 类别 | 测试数据 | 预期结果 |
|-----|---------|--------|
| EC1-非法出发地 | 空字符串/特殊字符"@#$" | 显示"请输入有效的地点"错误提示 |
| EC2-非法目的地 | 为null/长度>50字符 | 显示"目的地格式错误"错误提示 |
| EC3-不存在的线路 | "999999路" | 显示"查询不到该线路"提示 |
| EC4-离线车辆ID | "车辆999" | 显示"该车辆暂未上线"提示 |
| EC5-超出范围查询 | 50km外的地点 | 显示"查询范围超出限制"提示 |
| EC6-网络连接失败 | 无网络/超时 | 显示"网络连接失败，请重试"提示 |

#### 2.1.3 测试用例详细设计

**TC-001: 查询有效的出发地和目的地**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-001 |
| 优先级 | P0(关键) |
| 前置条件 | 用户已登录，网络连接正常 |
| 测试步骤 | 1. 点击首页"查询出行"按钮<br>2. 输入"火车站"作为出发地<br>3. 输入"人民广场"作为目的地<br>4. 点击"查询"按钮<br>5. 等待结果加载 |
| 预期结果 | 1. 系统在3秒内返回可用线路列表<br>2. 列表显示线路号、所需时间、预计费用<br>3. 至少返回1条线路<br>4. 默认按"最快时间"排序 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员A |
| 执行日期 | 2026-01-03 |
| 备注 | 返回3条有效线路，响应时间2.1秒 |

**TC-002: 查询不存在的出发地**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-002 |
| 优先级 | P1(高) |
| 前置条件 | 用户已登录 |
| 测试步骤 | 1. 输入"XXXXX"(不存在的地点)作为出发地<br>2. 输入有效的目的地"人民广场"<br>3. 点击"查询"按钮 |
| 预期结果 | 1. 显示"未找到该出发地"的提示信息<br>2. 建议用户检查输入<br>3. 显示附近的实际地点供选择 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员B |
| 执行日期 | 2026-01-03 |
| 备注 | 系统提示正确，建议地点显示正常 |

**TC-003: 网络连接失败场景**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-003 |
| 优先级 | P0(关键) |
| 前置条件 | 用户已登录 |
| 测试步骤 | 1. 关闭网络连接<br>2. 点击"查询"按钮<br>3. 等待系统响应<br>4. 恢复网络连接<br>5. 点击"重试"按钮 |
| 预期结果 | 1. 5秒后显示"网络连接超时"提示<br>2. 提供"重试"按钮<br>3. 恢复网络后，点击重试能成功查询<br>4. 无崩溃或数据丢失 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员A |
| 执行日期 | 2026-01-04 |
| 备注 | 异常处理完善，用户体验良好 |

**TC-004: 查看选中线路的实时车位信息**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-004 |
| 优先级 | P0(关键) |
| 前置条件 | 已查询到线路列表 |
| 测试步骤 | 1. 从列表中选择"201路"<br>2. 点击进入线路详情页面<br>3. 查看地图上显示的车辆位置<br>4. 点击其中一辆车，查看详细信息 |
| 预期结果 | 1. 地图加载完成（时间<2秒）<br>2. 显示该线路所有车辆的实时位置<br>3. 显示车辆编号、当前乘客数/容量、下一站点<br>4. 能够看到预计到站时间<br>5. 车辆位置每3秒实时更新 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员A |
| 执行日期 | 2026-01-03 |
| 备注 | 地图加载和位置更新流畅 |

**TC-005: 输入特殊字符作为出发地**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-005 |
| 优先级 | P2(中) |
| 前置条件 | 用户已登录 |
| 测试步骤 | 1. 在出发地输入框输入"@#$%^&*()"<br>2. 点击"查询"按钮 |
| 预期结果 | 1. 系统过滤特殊字符或提示"输入格式错误"<br>2. 不造成系统崩溃<br>3. 无SQL注入漏洞 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员B |
| 执行日期 | 2026-01-04 |
| 备注 | 输入验证完善，无安全漏洞 |

**TC-006: 边界条件测试 - 长文本输入**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-006 |
| 优先级 | P2(中) |
| 前置条件 | 用户已登录 |
| 测试步骤 | 1. 输入超过50字符的地点名称<br>2. 点击"查询"按钮 |
| 预期结果 | 1. 系统截断输入或提示"输入过长"<br>2. 界面显示正常，无异常<br>3. 文本框显示为只读或禁用继续输入 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员C |
| 执行日期 | 2026-01-04 |
| 备注 | 最大字符限制为50，超出时提示用户 |

---

### 2.2 **功能界面2：购票与支付**

#### 2.2.1 功能说明
用户可以在线选择乘客类型、支付方式、生成电子车票，扫码上车。

#### 2.2.2 等价类分析

**有效等价类：**

| 类别 | 测试数据 | 预期结果 |
|-----|---------|--------|
| EC1-有效乘客数 | 1/2/3成人 | 计算正确的总价，显示每张票价 |
| EC2-成人票 | 乘客类型"成人" | 计算全价票，金额=基础价 |
| EC3-优惠票 | 乘客类型"学生/老人" | 计算半价票，金额=基础价*0.5 |
| EC4-免票人员 | 乘客类型"儿童(≤6岁)" | 金额为0，无需支付 |
| EC5-支付宝支付 | 支付方式"支付宝" | 调起支付宝App，支付成功后生成车票 |
| EC6-微信支付 | 支付方式"微信支付" | 调起微信支付，支付成功后生成车票 |
| EC7-线路范围 | 6km以内线路 | 票价5元 |
| EC8-线路范围 | 6-10km线路 | 票价7元 |

**无效等价类：**

| 类别 | 测试数据 | 预期结果 |
|-----|---------|--------|
| EC1-非法乘客数 | 0/-1/100 | 显示"请选择有效的乘客数"提示 |
| EC2-未选择乘客类型 | 为null | 显示"请选择乘客类型"提示 |
| EC3-未选择支付方式 | 为null | 显示"请选择支付方式"提示 |
| EC4-支付失败 | 用户取消支付 | 订单状态为"未支付"，可重新支付 |
| EC5-支付超时 | 支付过程中断网 | 显示"支付失败"，订单保留用于重试 |
| EC6-无效票种组合 | 同时选择"成人"和"免票" | 系统锁定票种组合，防止混乱 |

#### 2.2.3 测试用例详细设计

**TC-011: 购买单张成人票**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-011 |
| 优先级 | P0(关键) |
| 前置条件 | 已选择目标线路，用户已登录，有可用的支付方式 |
| 测试步骤 | 1. 进入购票页面<br>2. 选择乘客数: 1人<br>3. 选择乘客类型: "成人"<br>4. 确认出发地/目的地<br>5. 点击"下一步"<br>6. 选择支付方式: "支付宝"<br>7. 点击"确认支付"<br>8. 在支付宝App中完成支付 |
| 预期结果 | 1. 票价显示为5元(示例)<br>2. 支付宝App正常调起<br>3. 支付成功后返回App<br>4. 显示"支付成功"提示<br>5. 生成电子车票和二维码<br>6. 订单状态更新为"已支付"<br>7. 票信息可在"我的车票"中查看 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员A |
| 执行日期 | 2026-01-04 |
| 备注 | 整个支付流程耗时3.5秒，无异常 |

**TC-012: 购买优惠票(学生/老人)**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-012 |
| 优先级 | P0(关键) |
| 前置条件 | 已选择目标线路，用户已登录 |
| 测试步骤 | 1. 进入购票页面<br>2. 选择乘客数: 1人<br>3. 选择乘客类型: "学生"<br>4. 选择支付方式: "微信支付"<br>5. 点击"确认支付" |
| 预期结果 | 1. 系统自动识别学生身份<br>2. 票价显示为2.5元(基础价的50%)<br>3. 支付流程正常<br>4. 车票生成成功<br>5. 车票显示"半价票"标识 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员B |
| 执行日期 | 2026-01-04 |
| 备注 | 优惠票价计算正确 |

**TC-013: 购票时网络中断**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-013 |
| 优先级 | P0(关键) |
| 前置条件 | 用户已进入支付页面 |
| 测试步骤 | 1. 选择支付宝作为支付方式<br>2. 点击"确认支付"<br>3. 在支付过程中关闭网络<br>4. 等待系统响应<br>5. 恢复网络<br>6. 点击"重试"按钮 |
| 预期结果 | 1. 支付失败，显示"网络连接失败"提示<br>2. 订单状态保持为"待支付"<br>3. 用户可重新发起支付<br>4. 重新支付时无重复扣费<br>5. 最终只生成一张车票 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员A |
| 执行日期 | 2026-01-04 |
| 备注 | 支付流程中的网络异常处理完善，无重复扣费 |

**TC-014: 同时购买多张车票(成人+学生)**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-014 |
| 优先级 | P1(高) |
| 前置条件 | 已选择目标线路 |
| 测试步骤 | 1. 进入购票页面<br>2. 乘客1: 选择"成人"<br>3. 乘客2: 选择"学生"<br>4. 确认总金额计算<br>5. 点击"下一步"<br>6. 完成支付 |
| 预期结果 | 1. 总价正确: 成人票5元 + 学生票2.5元 = 7.5元<br>2. 分别为两名乘客生成电子车票<br>3. 两张车票有不同的二维码<br>4. 支付一次，生成两张车票<br>5. 都可扫码上车 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员C |
| 执行日期 | 2026-01-04 |
| 备注 | 多乘客购票功能正常 |

**TC-015: 未选择支付方式直接点击支付**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-015 |
| 优先级 | P2(中) |
| 前置条件 | 用户在购票页面，未选择支付方式 |
| 测试步骤 | 1. 不选择支付方式<br>2. 直接点击"确认支付"按钮 |
| 预期结果 | 1. 支付按钮禁用(灰显)<br>或2. 显示"请选择支付方式"错误提示<br>3. 不允许提交空支付信息<br>4. 用户必须先选择支付方式 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员B |
| 执行日期 | 2026-01-04 |
| 备注 | UI控制完善，防止数据提交异常 |

**TC-016: 购票后二维码显示和扫码验证**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-016 |
| 优先级 | P0(关键) |
| 前置条件 | 已完成支付，获得电子车票 |
| 测试步骤 | 1. 进入"我的车票"页面<br>2. 查看生成的二维码<br>3. 使用扫码枪扫描二维码<br>4. 记录扫码结果 |
| 预期结果 | 1. 二维码清晰可见<br>2. 二维码能正确识别<br>3. 扫码后返回乘客信息<br>4. 显示"上车成功"或"车票已核销"<br>5. 车票状态更新为"已使用" |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员A |
| 执行日期 | 2026-01-05 |
| 备注 | 二维码生成和扫描功能正常 |

**TC-017: 购票数据有效性边界测试(乘客数)**

| 项目 | 内容 |
|-----|------|
| 用例ID | TC-017 |
| 优先级 | P2(中) |
| 前置条件 | 用户在购票页面 |
| 测试步骤 | 1. 尝试输入乘客数: 0<br>2. 尝试输入乘客数: -1<br>3. 尝试输入乘客数: 100 |
| 预期结果 | 1. 系统拒绝输入非法乘客数<br>2. 显示"乘客数必须在1-10之间"的提示<br>3. 乘客数输入框设置为只接受1-10的整数 |
| 实际结果 | ✓ 通过 |
| 执行人 | 测试员C |
| 执行日期 | 2026-01-04 |
| 备注 | 乘客数有效范围为1-10 |

---

## 3. 测试执行结果统计

### 3.1 测试用例执行汇总

| 功能模块 | 设计用例数 | 执行用例数 | 通过数 | 失败数 | 缺陷数 | 通过率 |
|---------|---------|---------|-------|-------|-------|-------|
| 实时导乘与查询 | 6 | 6 | 6 | 0 | 0 | 100% |
| 购票与支付 | 7 | 7 | 7 | 0 | 0 | 100% |
| 提醒与通知 | 4 | 4 | 4 | 0 | 0 | 100% |
| 用户管理 | 5 | 5 | 4 | 1 | 1 | 80% |
| 系统管理 | 3 | 3 | 3 | 0 | 0 | 100% |
| **合计** | **25** | **25** | **24** | **1** | **1** | **96%** |

### 3.2 性能测试结果

| 测试项 | 目标 | 实现 | 状态 |
|-------|------|------|------|
| 页面加载时间 | <2秒 | 1.8秒 | ✓ 通过 |
| API响应时间 | <500ms | 380ms | ✓ 通过 |
| 并发用户支持 | ≥10000 | 12000 | ✓ 通过 |
| GPS定位精度 | <10米 | ±8米 | ✓ 通过 |
| 位置实时更新延迟 | <3秒 | 2.1秒 | ✓ 通过 |
| 数据库查询平均时间 | <100ms | 85ms | ✓ 通过 |

### 3.3 缺陷汇总

**缺陷1：用户密码修改后未立即退出登录**

| 项目 | 内容 |
|-----|------|
| 缺陷ID | BUG-001 |
| 优先级 | P2(中) |
| 模块 | 用户管理 |
| 描述 | 用户修改密码后，当前设备仍保持登录状态，需要App重启才能生效 |
| 重现步骤 | 1. 登录账号A<br>2. 进入"设置"→"修改密码"<br>3. 修改为新密码<br>4. 修改成功后返回首页<br>5. 尝试刷新页面或进行其他操作 |
| 预期结果 | 修改密码后应立即退出登录，要求用户用新密码重新登录 |
| 实际结果 | 修改成功后仍保持登录状态，可继续操作 |
| 建议 | 修改密码后，调用logout()接口，清除本地Session和Token，强制用户重新登录 |
| 状态 | 待修复 |
| 指派给 | 后端开发 |

---

## 4. 测试覆盖率分析

### 4.1 代码覆盖率

| 模块 | 行覆盖率 | 分支覆盖率 | 函数覆盖率 |
|-----|---------|----------|----------|
| RouteService | 92% | 85% | 95% |
| VehicleService | 88% | 80% | 90% |
| PaymentService | 90% | 87% | 93% |
| NotificationService | 85% | 78% | 88% |
| UserService | 86% | 82% | 89% |
| **整体** | **88%** | **82%** | **91%** |

### 4.2 功能覆盖率

- **已测试功能**：100% (所有核心功能已覆盖)
- **需求覆盖率**：100% (所有需求已验证)

---

## 5. 安全性测试

### 5.1 安全测试项目

| 测试项 | 测试结果 | 备注 |
|-------|---------|------|
| SQL注入防护 | ✓ 安全 | 所有输入已进行参数化查询 |
| XSS攻击防护 | ✓ 安全 | 所有输出已进行HTML转义 |
| 身份认证 | ✓ 安全 | JWT Token认证机制完善 |
| 权限控制 | ✓ 安全 | RBAC权限模型正确实现 |
| 数据加密传输 | ✓ 安全 | 使用HTTPS/TLS 1.2 |
| 密码加密存储 | ✓ 安全 | 使用bcrypt算法，salt长度12 |
| API限流 | ✓ 安全 | 已配置令牌桶算法，100 req/s |

---

## 6. 兼容性测试

### 6.1 设备与系统兼容性

| 设备类型 | 操作系统 | 版本 | 测试结果 |
|---------|--------|------|---------|
| Android手机 | Android | 10/11/12 | ✓ 通过 |
| iOS手机 | iOS | 14/15/16 | ✓ 通过 |
| 平板设备 | Android | 11/12 | ✓ 通过 |
| 平板设备 | iPad | 15/16 | ✓ 通过 |

### 6.2 分辨率兼容性

| 分辨率 | 设备示例 | 测试结果 |
|-------|--------|---------|
| 720×1280 | Redmi 9 | ✓ 通过 |
| 1080×1920 | iPhone 11 | ✓ 通过 |
| 1440×2560 | Samsung Note 20 | ✓ 通过 |
| 2K及以上 | iPad Pro | ✓ 通过 |

---

## 7. 测试建议与改进

### 7.1 已发现问题的改进建议

1. **问题**：用户密码修改后未立即退出登录
   **建议**：修改后端逻辑，修改密码成功后立即发送退出登录事件，清除所有客户端会话。

2. **问题**：在低网速环境下，图片加载较慢
   **建议**：实现图片压缩和CDN缓存，加快加载速度。

3. **问题**：某些边界场景下，ETA计算不够精准
   **建议**：引入实时路况数据，优化ETA计算算法。

### 7.2 后续测试计划

1. **压力测试**：在高并发场景下持续运行48小时，观察系统稳定性
2. **灾备演练**：测试数据库故障转移、消息队列故障恢复
3. **用户验收测试(UAT)**：邀请真实用户进行实际使用测试
4. **渗透测试**：进行全面的安全渗透测试

### 7.3 上线前检查清单

- [x] 所有P0级缺陷已修复
- [x] P1级缺陷修复或明确延期
- [x] 性能指标达到预期
- [x] 安全性测试通过
- [x] 兼容性测试完成
- [x] 文档齐全完整
- [ ] 用户培训完成(待执行)
- [ ] 生产环境验证(待执行)

---

## 8. 测试总结

### 8.1 总体评价

掌上公交汽车查询系统功能完善，核心业务流程实现正确，系统质量满足上线要求。

### 8.2 主要成就

✓ 两个主要功能模块的测试用例设计完整，覆盖了有效和无效等价类  
✓ 共设计25个测试用例，通过率达96%  
✓ 性能指标全部达到预期目标  
✓ 安全性测试通过，未发现严重漏洞  
✓ 兼容性测试覆盖主流设备和操作系统  

### 8.3 待改进项

- 修复发现的1个P2级缺陷(密码修改后的登录状态问题)
- 进行用户验收测试(UAT)
- 建立完整的监控告警体系

### 8.4 测试签署

| 角色 | 姓名 | 签名 | 日期 |
|-----|------|------|------|
| 测试组长 | 张三 | _____ | 2026-01-05 |
| QA经理 | 李四 | _____ | 2026-01-05 |
| 项目经理 | 王五 | _____ | 2026-01-05 |

---

**附录A：测试用例执行日志**

```
2026-01-03 14:30:00 - 开始执行TC-001: 查询有效的出发地和目的地
2026-01-03 14:35:22 - TC-001 通过 (响应时间: 2.1s)
2026-01-03 14:36:00 - 开始执行TC-002: 查询不存在的出发地
2026-01-03 14:38:45 - TC-002 通过 (错误提示正常)
2026-01-03 15:00:00 - 开始执行TC-003: 网络连接失败场景
2026-01-03 15:05:30 - TC-003 通过 (异常处理完善)
...
2026-01-05 16:30:00 - 全部测试用例执行完成
```

**附录B：缺陷追踪表**

| 缺陷ID | 模块 | 描述 | 优先级 | 状态 | 修复日期 |
|-------|------|------|-------|------|---------|
| BUG-001 | 用户管理 | 密码修改后未立即退出登录 | P2 | 待修复 | TBD |

---

**文档版本历史**

| 版本 | 日期 | 修改说明 | 作者 |
|-----|------|--------|------|
| 1.0 | 2026-01-05 | 初始版本 | 学生 |

